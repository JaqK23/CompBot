ROLL =LAMBDA(arr,[horizontal],[vertical], LET(horizontal, IF(ISOMITTED(horizontal), 0, horizontal), vertical, IF(ISOMITTED(vertical), 0, vertical), width, COUNT(TAKE(arr, 1)), height, COUNT(TAKE(arr, , 1)), horizontal_mod, IF(ABS(horizontal) > width, MOD(horizontal, width), horizontal), vertical_mod, IF(ABS(vertical) > height, MOD(vertical, height), vertical), h_fixed, IF(horizontal_mod < 0, width + horizontal_mod, horizontal_mod), v_fixed, IF(vertical_mod < 0, height + vertical_mod, vertical_mod), r, IF(horizontal_mod < 0, width - (h_fixed), width - h_fixed), u, IF(vertical_mod < 0, height - (v_fixed), height - v_fixed), lr_roll, IF(OR(h_fixed = 0, h_fixed = width), arr, HSTACK(TAKE(arr, , -h_fixed), TAKE(arr, , r))), final_roll, IF(OR(v_fixed = 0, v_fixed = height), lr_roll, VSTACK(TAKE(lr_roll, -v_fixed), TAKE(lr_roll, u))), final_roll));