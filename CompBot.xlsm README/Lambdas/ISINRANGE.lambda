ISINRANGE =LAMBDA(cell,bear,x,y,[lookup_output],[default],[id], LET(default, IF(ISOMITTED(default), 0, default), lookup_output, IF(ISOMITTED(lookup_output), 1, lookup_output), a, MAX(IF(COUNTIF(INDIRECT(Loc.SHIFT_OOB(CELL("address", cell), -x, -y) & ":" & Loc.SHIFT_OOB(CELL("address", cell), x, y)), bear), IF(ISOMITTED(id), 1, id), default)), IF(ISOMITTED(id), IF(a <> 0, a, default), XLOOKUP(a, id, lookup_output, default))));