DATEHEADERS =LAMBDA(start_date,periods,type, LET(month_num, IFS(type = "Y", 12, type = "Q", 3, type = "M", 1), HSTACK(VSTACK("Start Date", "End Date", "Period #", "Year", "Month", "Jan Flag"), VSTACK(EDATE(start_date, SEQUENCE(, periods, 0, month_num)), EOMONTH(EDATE(start_date, SEQUENCE(, periods, 0, month_num)), month_num - 1), SEQUENCE(, periods), YEAR(EDATE(start_date, SEQUENCE(, periods, 0, month_num))), MONTH(EDATE(start_date, SEQUENCE(, periods, 0, month_num))), --MONTH(EDATE(start_date, SEQUENCE(, periods, 0, month_num))) = 1))));