LISTOFFSET =LAMBDA(array,curr,offset,booLoop, LET(tarr, IF(ROWS(array) > 1, array, TRANSPOSE(array)), cnt, ROWS(tarr), off, IF(ABS(offset) > cnt, SIGN(offset) * (MOD(ABS(offset) + 1, cnt) - 1), offset), idx, IF(OR(curr + off < 1, curr + off > cnt), IF(booLoop, IF(curr + off < 1, cnt + curr + off, curr + off - cnt), 0), curr + off), return, IF(idx = 0, 0, INDEX(tarr, idx)), return));