AMATCHADD =LAMBDA(rng,trg,[Actual], LET(vals, TOCOL(rng), strw, IF(Actual = 1, ROW(TAKE(rng, 1, 1)) - 1, 0), stcl, IF(Actual = 1, COLUMN(TAKE(rng, 1, 1)) - 1, 0), rws, TOCOL(SEQUENCE(ROWS(rng)) + 0 * SEQUENCE(, COLUMNS(rng))), cls, TOCOL(SEQUENCE(ROWS(rng)) * 0 + SEQUENCE(, COLUMNS(rng))), Mrws, TOROW(FILTER(rws, (vals = trg) * (vals <> ""))), Mcls, TOROW(FILTER(cls, (vals = trg) * (vals <> ""))), TRANSPOSE(ADDRESS(strw + Mrws, stcl + Mcls, 4))));